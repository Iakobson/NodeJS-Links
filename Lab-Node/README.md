# Lab Node

- - -

### HW-1

Для запуску вашого Node.js додатку та перевірки його роботи у **Visual Studio Code** з розширенням **Thunder Client**, слід виконати наступні кроки:

1. Відкрити проект у VS Code:
    - впевніться, що у вас є файли package.json, index.js, filesRouter.js, helpers.js і filesService.js в кореневій папці проекту.
2. Встановити залежності:
    - Відкрийте термінал в VS Code і запустіть команду `npm install` для встановлення всіх залежностей, зазначених у файлі package.json.
3. Запустити сервер:
    - В терміналі VS Code запустіть команду `npm start`, яка запустить ваш сервер Node.js.
    - Ви побачите повідомлення про те, що сервер запущено на порту 8080 (або іншому порту, якщо ви змінили конфігурацію).
4. Перевірити додаток за допомогою Thunder Client:
    - У VSCode перейдіть до розділу Thunder Client у вашому боковому меню.
    - Створіть новий запит (Request) для тестування вашого сервера. Натисніть кнопку "New Request" або аналогічну, якщо вона є у вашому розширенні.
    - У налаштуваннях запиту вкажіть URL, який ви хочете перевірити (наприклад, http://localhost:8080/api/files).
    - Оберіть тип запиту (GET, POST, PUT, DELETE) в залежності від того, яку операцію ви хочете виконати.
    - Додайте необхідні параметри запиту, якщо це потрібно (наприклад, тіло POST-запиту для створення файлу).
5. Відправити запит:
    - Натисніть кнопку "Send" або аналогічну, щоб відправити запит на сервер.
6. Перевірити відповідь:
    - Після відправлення запиту ви побачите відповідь від сервера у вікні Thunder Client.
    - Тут ви зможете перевірити, чи працює ваш сервер правильно, і перевірити відповіді на ваші запити.

> Ви можете створити різні запити для перевірки всіх функцій вашого сервера, включаючи створення файлів, отримання списку файлів, отримання вмісту файлів тощо. Не забудьте змінити URL і параметри запитів відповідно до вашої реалізації сервера.

#### Запити

* **Отримання списку файлів:**
  + URL: `http://localhost:8080/api/files`
  + Тип запиту: `GET`
  + Тіло запиту: 
  + Примітка: _Цей запит повинен повернути список всіх завантажених файлів._
* **Створення нового захищеного файлу:**
  + URL: `http://localhost:8080/api/files`
  + Тип запиту: `POST`
  + Тіло запиту:
    ```JSON
      {
        "filename": "someFile.txt",
        "content": "Це вміст нового файлу # 1. Він захищений паролем.",
        "password": "мійсуперпароль"
      }
    ```
  + Примітка: _Цей запит створить новий файл з ім'ям "someFile.txt" та вказаним вмістом._
* **Створення нового звичайного файлу:**
  + URL: `http://localhost:8080/api/files`
  + Тип запиту: `POST`
  + Тіло запиту:
    ```JSON
      {
        "filename": "newfile.txt",
        "content": "Це вміст нового файлу # 2."
      }
    ```
  + Примітка: _Цей запит створить новий файл з ім'ям "newfile.txt" та вказаним вмістом._
* **Спроба створення вже існуючого файлу:**
  + URL: `http://localhost:8080/api/files`
  + Тип запиту: `POST`
  + Тіло запиту:
    ```JSON
      {
        "filename": "steps.txt",
        "content": "Пробуємо створити новий файл, який вже існує."
      }
    ```
  + Примітка: _Має видатися повідомлення про існування такого файлу._
* **Отримання вмісту захищеного файлу:**
  + URL: `http://localhost:8080/api/files/someFile.txt?password=мійсуперпароль`
  + Тип запиту: `GET`
  + Тіло запиту:    
  + Примітка: _ Цей запит повинен повернути вміст файлу з ім'ям "someFile.txt"._
* **Отримання вмісту звичайного файлу:**
  + URL: `http://localhost:8080/api/files/steps.txt`
  + Тип запиту: `GET`
  + Тіло запиту:   
  + Примітка: _ Цей запит повинен повернути вміст файлу з ім'ям "steps.txt"._
* **Оновлення вмісту звичайного файлу:**
  + URL: `http://localhost:8080/api/files/newfile.txt`
  + Тип запиту: `PUT`
  + Тіло запиту:
    ```JSON
      {
        "updatedText": "Новий вміст для файлу."
      }
    ```
  + Примітка: _Цей запит повинен оновити вміст файлу "newfile.txt" зазначеним текстом._
* **Оновлення вмісту захищеного файлу:**
  + URL: `http://localhost:8080/api/files/someFile.txt`
  + Тип запиту: `PUT`
  + Тіло запиту:
    ```JSON
      {
        "updatedText": "Новий вміст для файлу.",
        "password": "мійсуперпароль"
      }
    ```
  + Примітка: _Цей запит повинен оновити вміст файлу "newfile.txt" зазначеним текстом._
* **Видалення файлу:**
  + URL: `http://localhost:8080/api/files/newfile.txt`
  + Тип запиту: `DELETE`
  + Тіло запиту:
  + Примітка: _Цей запит повинен видалити файл "newfile.txt"._

- - -

### примітки

> це дуже важливо бо одна помилка і сервак впав

* бажано зробити middleware
  - в якому ти робиш json.verify(token, SECRET_KEY)
* обгортаєш це в try catch
  - там якщо токен не підходить по ключу то кидає помилку
* якщо токен пройшов то json.verify вертає закодований payload
  - який ти можеш присвоїти для req.user
* i викликати next
  - який уже попадає в твою основну функцію обробки, там витягуєш з req.user айдішку і по ній можеш сміло що хочеш шукати
* тут postgre база даних юзається

![middleware](https://github.com/Iakobson/NodeJS-Links/blob/main/Lab-Node/required-1.jpg)

При відправці форми з логіном і паролем отримуємо токен, перевіряєм чи все ок з респонсом і записуємо його в session storage.

![middleware](https://github.com/Iakobson/NodeJS-Links/blob/main/Lab-Node/required-2.jpg)

- - -


