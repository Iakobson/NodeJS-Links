# Робота з файлами

#### Ось деякі поради та покращення для коду, що має операції читання файлів

+ Перевірка наявності файлу:
    - Додайте перевірку наявності файлу перед спробою читання. Це дозволить уникнути помилок, якщо файл не існує.
+ Обробка помилок асинхронного читання:
    - Обережно обробляйте помилки під час асинхронного читання файлів.
    - Якщо ви використовуєте throw error, то краще було б вивести помилку і продовжити виконання програми, а не призупиняти її роботу.
    - Ви можете використовувати конструкцію try...catch для цього.
+ Закриття файлу:
    - Якщо ви використовуєте синхронне читання файлу, то необхідно закрити файл після читання.
    - Ви можете це зробити, використовуючи fs.closeSync().

**Приклад читання двох файлів:**

```javascript
// node filefs.js
const fs = require("fs");

console.log("1. Початок роботи модуля FS.")

// Асинхронне читання
fs.readFile("files/hitestasync.txt", "utf8", (error, data) => {
    if (error) {
        console.error("Помилка асинхронного читання файлу:", error);
    } else {
        console.log("2. Відбувається асинхронне читання файлу");
        console.log(data); // Виводимо считані дані
    }
});

// Синхронне читання
try {
    console.log("3. Відбувається синхронне читання файлу");
    let fileContent = fs.readFileSync("files/hitestsync.txt", "utf8");
    console.log(fileContent);
} catch (error) {
    console.error("Помилка синхронного читання файлу:", error);
}
```

_І тут варто звернути увагу, що незважаючи на те, що функція ``fs.readFile()`` викликається першою, але оскільки вона асинхронна, вона не блокує потік виконання, тому результат виводиться в самому кінці._

**Додаємо в приклад операцію по запису у файл**

Як допоміжний параметр у функцію може передаватися функція зворотного виклику, яка виконується після завершення запису:

```javascript
// Асинхронний запис в файл
const contentToWrite = "Це новий доданий контент для файлу!";

fs.writeFile("files/writeasync.txt", contentToWrite, (error) => {
    if (error) {
        console.error("Помилка асинхронного запису файлу:", error);
    } else {
		console.log("4. Розпочинаємо асинхронний запис у файл..");
        console.log("Асинхронний запис файлу завершено.");
        console.log("Оновлений зміст файлу:");

        // Перевірка наявності файлу перед читанням
        if (fs.existsSync("files/writeasync.txt")) {
            let newData = fs.readFileSync("files/writeasync.txt", "utf8");
            console.log(newData);
        } else {
            console.error("Файл не існує.");
        }
    }
});
```

> Операція fs.writeFile перезапише вміст файлу новими даними. Тобто, якщо файл writeasync.txt вже існує, то вміст файлу буде замінений на новий, який ви передаєте у функцію fs.writeFile. Якщо файл не існує, він буде створений, і в нього буде записаний новий вміст.











